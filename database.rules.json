{
  "rules": {
    ".read": true,
    ".write":true,
    "questions": {
      ".read" : true,
      "$qid": {
        ".write": "auth != null && newData.exists()"
      }
    },
    "tags": {
      ".read": true,
      "$tagID": {
        "questions": {
          "$qID": {
            ".write": "auth != null && !data.exists()"
          }
        },
        "experts": {
          "$expertID": {
            ".write": "auth != null && root.child('userPublicSummary/'+$expertID).exists()"
          }
        },
        "related": {
          "$tagID": {
            ".write": "auth != null && root.child('tags/'+$tagID).exists()"
          }
        },
        "description": {
            ".write": "auth != null"
        },
        "title": {
            ".write": "auth != null"
        }      
      }
    },
    "users": {
      "$uid": {
        ".read": "$uid === auth.uid",
        "savedQuestions": {
          ".indexOn" : "lastAnswerID",
          ".write": "$uid === auth.uid"
        },
        "savedTags" : {
          ".write": "$uid === auth.uid"
        },
        "unreadMessages" : {
          ".write": "auth != null"
        },
        "conversations" : {
          ".write": "auth != null",
        },
      	"askedQuestions" : {
          ".write": "auth != null && $uid === auth.uid",
        }
      }
    },
    "userPublicSummary": {
      ".read": true,
      "$uid": {
      	".indexOn": "name",
        ".write": "$uid === auth.uid"
      }
    },
    "userDetailedPublicSummary": {
      ".read": true,
      "$uid": {
        ".write": "$uid === auth.uid"
      }
    },
    "userLocations": {
      "$uid": {
        ".read": true,
        ".write": "$uid === auth.uid"
      }
    },
    "answers": {
      "$aid": {
        ".read": true,
        ".write": "auth != null && !data.exists() || newData.exists() && !newData.child('qID').exists() || !root.child('userDetailedPublicSummary/'+auth.uid+'/answeredQuestions/'+newData.child('qID').val()).exists()"
      }
    },
    "answerVotes": {
      "$aid": {
        ".read": true,
        ".write": "auth != null"
      }
    },
    "answerCollections": {
      "$aid": {
        ".read": true,
        ".write": "auth != null"
      }
    },
    "conversations": {
      "$cid": {
        ".read": "auth != null",
        ".write": "auth != null"
      }
    },
    "filters": {
      "$filterID": {
        ".read": true,
        ".write": "auth != null"
      }
    },
    "messages": {
      "$msgID": {
        ".read": "auth != null && data.child('fromID').val() === auth.uid || data.child('toID').val() === auth.uid",
        ".write": "auth != null && !data.exists() || newData.exists()"
      }
    },
    "questionSearchIndex": {
      ".read": true,
      ".write": "auth != null"
    },
    "tagSearchIndex": {
      ".read": true,
      ".write": "auth != null"
    },
    "settings": {
      ".read": true,
      ".write": false
    },
    "settingsSections": {
      ".read": true,
      ".write": false
    },
  }
}